PrimeFaces.widget.Tooltip=PrimeFaces.widget.BaseWidget.extend({init:function(a){this.cfg=a;this.id=this.cfg.id;this.cfg.showEvent=this.cfg.showEvent?this.cfg.showEvent+".tooltip":"mouseover.tooltip";this.cfg.hideEvent=this.cfg.hideEvent?this.cfg.hideEvent+".tooltip":"mouseout.tooltip";this.cfg.showEffect=this.cfg.showEffect?this.cfg.showEffect:"fade";this.cfg.hideEffect=this.cfg.hideEffect?this.cfg.hideEffect:"fade";this.cfg.showDelay=this.cfg.showDelay||150;this.cfg.hideDelay=this.cfg.hideDelay||0;if(this.cfg.target){this.bindTarget()}else{this.bindGlobal()}this.removeScriptElement(this.id)},refresh:function(a){if(a.target){$(document.body).children(PrimeFaces.escapeClientId(a.id)).remove()}else{$(document.body).children(".ui-tooltip-global").remove()}this._super(a)},bindGlobal:function(){this.jq=$('<div class="ui-tooltip ui-tooltip-global ui-widget ui-widget-content ui-corner-all ui-shadow" />').appendTo("body");this.cfg.globalSelector=this.cfg.globalSelector||"a,:input,:button";this.cfg.escape=(this.cfg.escape===undefined)?true:this.cfg.escape;var b=this;$(document).off(this.cfg.showEvent+" "+this.cfg.hideEvent,this.cfg.globalSelector).on(this.cfg.showEvent,this.cfg.globalSelector,function(d){var c=$(this);if(c.prop("disabled")){return}if(b.cfg.trackMouse){b.mouseEvent=d}var g=c.attr("title");if(g){c.data("tooltip",g).removeAttr("title")}if(c.hasClass("ui-state-error")){b.jq.addClass("ui-state-error")}var f=c.data("tooltip");if(f){if(b.cfg.escape){b.jq.text(f)}else{b.jq.html(f)}b.globalTitle=f;b.target=c;b.show()}}).on(this.cfg.hideEvent+".tooltip",this.cfg.globalSelector,function(){if(b.globalTitle){b.hide();b.globalTitle=null;b.target=null;b.jq.removeClass("ui-state-error")}});var a="resize.tooltip";$(window).unbind(a).bind(a,function(){if(b.jq.is(":visible")){b.align()}})},bindTarget:function(){this.id=this.cfg.id;this.jqId=PrimeFaces.escapeClientId(this.id);this.jq=$(this.jqId);this.target=PrimeFaces.expressions.SearchExpressionFacade.resolveComponentsAsSelector(this.cfg.target);var b=this;this.target.off(this.cfg.showEvent+" "+this.cfg.hideEvent).on(this.cfg.showEvent,function(c){if(b.cfg.trackMouse){b.mouseEvent=c}b.show()}).on(this.cfg.hideEvent+".tooltip",function(){b.hide()});this.jq.appendTo(document.body);if($.trim(this.jq.html())===""){this.jq.html(this.target.attr("title"))}this.target.removeAttr("title");var a="resize."+this.id;$(window).unbind(a).bind(a,function(){if(b.jq.is(":visible")){b.align()}})},align:function(){this.jq.css({left:"",top:"","z-index":++PrimeFaces.zindex});if(this.cfg.trackMouse&&this.mouseEvent){this.jq.position({my:"left top+15",at:"right bottom",of:this.mouseEvent,collision:"flipfit"});this.mouseEvent=null}else{this.jq.position({my:"left top",at:"right bottom",of:this.target})}},show:function(){if(this.target){var a=this;this.clearTimeout();this.timeout=setTimeout(function(){a.align();if(a.cfg.trackMouse){a.followMouse()}a.jq.show(a.cfg.showEffect,{},250)},this.cfg.showDelay)}},hide:function(){var a=this;this.clearTimeout();if(this.cfg.hideDelay){this.timeout=setTimeout(function(){a._hide()},this.cfg.hideDelay)}else{this._hide()}},_hide:function(){var a=this;this.jq.hide(this.cfg.hideEffect,{},250,function(){$(this).css("z-index","");if(a.cfg.trackMouse){a.unfollowMouse()}})},clearTimeout:function(){if(this.timeout){clearTimeout(this.timeout)}},followMouse:function(){var a=this;this.target.on("mousemove.tooltip-track",function(b){a.jq.position({my:"left top+15",at:"right bottom",of:b,collision:"flipfit"})})},unfollowMouse:function(){this.target.off("mousemove.tooltip-track")}});