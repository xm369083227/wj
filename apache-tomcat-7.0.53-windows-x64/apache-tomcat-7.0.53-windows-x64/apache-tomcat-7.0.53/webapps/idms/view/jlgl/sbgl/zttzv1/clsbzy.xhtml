<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
	<title>设备转移单</title>
	<ui:include src="/common/templates/ui.xhtml"></ui:include>
</h:head>
<body style="border-bottom-width: 1px">
	<h:form id="form" style="text-align: center;"
		enctype="multipart/form-data">

		<p:panel id="thyy" rendered="#{zttzClsbSsbmZyJBean.ztxg.thyy!=null}"
			header="退回"
			style="width:800px;text-align: left;margin-left: -10px;margin-top: -10px;">
			<h:panelGroup>
				<p:outputLabel value="退回原因：" style="color:red"></p:outputLabel>
				<p:outputLabel value="#{zttzClsbSsbmZyJBean.ztxg.thyy}"
					style="color: black;font-weight: bold;"></p:outputLabel>
			</h:panelGroup>
		</p:panel>

		<p:tabView id="allform" style="text-align: left;">
			<div style="left: -10px;azimuth: "></div>

			<p:tab title="设备转移申请单">
				<p:panelGrid columns="1" width="900px" align="left">
					<f:facet name="header">
						<h:outputText value="设备转移申请"
							style="text-align: center;font-size:25px;"></h:outputText>
					</f:facet>
					<h:panelGrid columns="2" style="margin-left: 700px">
						<h:outputText value="填表日期："></h:outputText>
						<h:outputText value="#{zttzClsbSsbmZyJBean.ztxg.kssj}"
							readonly="true">
							<f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss" locale="zh_CN"
								timeZone="GMT+8" />
						</h:outputText>
					</h:panelGrid>
					<p:panel style="border:1px solid #ADADAD">
						<h:panelGrid columns="4" width="900px" align="left">
							<h:outputText value="申&nbsp;&nbsp;请&nbsp;&nbsp;人："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.sqr}" size="20"
								readonly="true"></p:inputText>
							<h:outputText value="申请日期："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.kssj}"
								readonly="true">
								<f:convertDateTime pattern="yyyy-MM-dd" locale="zh_CN"
									timeZone="GMT+8" />
							</p:inputText>
						</h:panelGrid>
					</p:panel>
					<p:panel style="border:1px solid #ADADAD">
						<h:panelGrid columns="4" width="900px" align="left">
							<h:outputText value="计量编号："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.sbglSbxx.jlbh}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="设备名称："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.sbglSbxx.sbmc}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="规格型号："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.sbglSbxx.ggxh}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="生产厂家："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.sbglSbxx.sccj}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="出厂编号："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.sbglSbxx.ccbh}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="原单位："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.yssbm}" size="20"
								readonly="true"></p:inputText>
						</h:panelGrid>
					</p:panel>
					<p:panel style="border:1px solid #ADADAD">
						<h:panelGrid columns="2" width="900px" align="left">
							<h:outputText value="接收单位："></h:outputText>
							<p:inputText value="#{zttzClsbSsbmZyJBean.ztxg.xssbm}" size="20"
								readonly="#{!zttzClsbSsbmZyJBean.showA}"></p:inputText>
							<h:panelGroup>
								<h:outputText value="转移原因："></h:outputText>
								<h:outputText value="*" style="color: red" />
							</h:panelGroup>
							<p:inputTextarea value="#{zttzClsbSsbmZyJBean.ztxg.xgyy}"
								rows="3" readonly="#{!zttzClsbSsbmZyJBean.showA}" cols="99"
								required="true" label="转移原因" maxlength="100"></p:inputTextarea>
							<h:outputText value="备注："></h:outputText>
							<p:inputTextarea value="#{zttzClsbSsbmZyJBean.ztxg.bz}" rows="3"
								readonly="#{!zttzClsbSsbmZyJBean.showA}" cols="99" label="备注"
								maxlength="100"></p:inputTextarea>
						</h:panelGrid>
					</p:panel>
					<p:panel style="border:1px solid #ADADAD">

						<h:panelGrid columns="4" width="900px" align="left">
							<h:outputText
								value="主管领导（原部门）：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_B.qzyhmc}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="审批日期："></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_B.qzrq}"
								readonly="true">
								<f:convertDateTime pattern="yyyy-MM-dd" locale="zh_CN"
									timeZone="GMT+8" />
							</p:inputText>
						</h:panelGrid>
						<h:panelGrid columns="2" width="900px" align="left">
							<h:outputText value="审批意见："></h:outputText>
							<p:inputTextarea rows="3"
								readonly="#{!zttzClsbSsbmZyJBean.showB}"
								style="border:#{zttzClsbSsbmZyJBean.taskNode=='主管领导（原部门）审批' ? '2px solid' : ''};border-color:#{zttzClsbSsbmZyJBean.taskNode=='主管领导（原部门）审批' ? '#46A3FF' : ''};"
								border="#{zttzClsbSsbmZyJBean.taskNode=='主管领导（原部门）审批' ? 1 : 0}"
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_B.qznr}"
								cols="99" label="审批意见" maxlength="100"></p:inputTextarea>
						</h:panelGrid>
					</p:panel>
					<p:panel style="border:1px solid #ADADAD">
						<h:panelGrid columns="4" width="900px" align="left">
							<h:outputText value="计量管理员（接收部门）："></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_C.qzyhmc}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="审批日期："></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_C.qzrq}"
								readonly="true">
								<f:convertDateTime pattern="yyyy-MM-dd" locale="zh_CN"
									timeZone="GMT+8" />
							</p:inputText>
						</h:panelGrid>
						<h:panelGrid columns="2" width="900px" align="left">
							<h:outputText value="审批意见："></h:outputText>
							<p:inputTextarea rows="3"
								readonly="#{!zttzClsbSsbmZyJBean.showC}"
								style="border:#{zttzClsbSsbmZyJBean.taskNode=='计量管理员（接收部门）审批' ? '2px solid' : ''};border-color:#{zttzClsbSsbmZyJBean.taskNode=='计量管理员（接收部门）审批' ? '#46A3FF' : ''};"
								border="#{zttzClsbSsbmZyJBean.taskNode=='计量管理员（接收部门）审批' ? 1 : 0}"
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_C.qznr}"
								cols="99" label="审批意见" maxlength="100"></p:inputTextarea>
						</h:panelGrid>

					</p:panel>
					<p:panel style="border:1px solid #ADADAD">
						<h:panelGrid columns="4" width="900px" align="left">
							<h:outputText value="主管领导（接收部门）审批：&nbsp;&nbsp;&nbsp;&nbsp;"></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_D.qzyhmc}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="审批日期："></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_D.qzrq}"
								readonly="true">
								<f:convertDateTime pattern="yyyy-MM-dd" locale="zh_CN"
									timeZone="GMT+8" />
							</p:inputText>
						</h:panelGrid>
						<h:panelGrid columns="2" width="900px" align="left">
							<h:outputText value="审批意见："></h:outputText>
							<p:inputTextarea rows="3"
								readonly="#{!zttzClsbSsbmZyJBean.showD}"
								style="border:#{zttzClsbSsbmZyJBean.taskNode=='主管领导（接收部门）审批' ? '2px solid' : ''};border-color:#{zttzClsbSsbmZyJBean.taskNode=='主管领导（接收部门）审批' ? '#46A3FF' : ''};"
								border="#{zttzClsbSsbmZyJBean.taskNode=='主管领导（接收部门）审批' ? 1 : 0}"
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_D.qznr}"
								cols="99" label="审批意见" maxlength="100"></p:inputTextarea>
						</h:panelGrid>
					</p:panel>
					<p:panel style="border:1px solid #ADADAD">
						<h:panelGrid columns="4" width="900px" align="left">
							<h:outputText
								value="计量科长：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_E.qzyhmc}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="审批日期："></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_E.qzrq}"
								readonly="true">
								<f:convertDateTime pattern="yyyy-MM-dd" locale="zh_CN"
									timeZone="GMT+8" />
							</p:inputText>
						</h:panelGrid>
						<h:panelGrid columns="2" width="900px" align="left">
							<h:outputText value="审批意见："></h:outputText>
							<p:inputTextarea rows="3"
								readonly="#{!zttzClsbSsbmZyJBean.showE}"
								style="border:#{zttzClsbSsbmZyJBean.taskNode=='计量科长审批' ? '2px solid' : ''};border-color:#{zttzClsbSsbmZyJBean.taskNode=='计量科长审批' ? '#46A3FF' : ''};"
								border="#{zttzClsbSsbmZyJBean.taskNode=='计量科长审批' ? 1 : 0}"
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_E.qznr}"
								cols="99" label="审批意见" maxlength="100"></p:inputTextarea>
						</h:panelGrid>
					</p:panel>
					<p:panel style="border:1px solid #ADADAD">
						<h:panelGrid columns="4" width="900px" align="left">
							<h:outputText
								value="专&nbsp;&nbsp;&nbsp;&nbsp;业&nbsp;&nbsp;&nbsp;&nbsp;组：&nbsp;&nbsp;&nbsp;&nbsp;"></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_F.qzyhmc}"
								size="20" readonly="true"></p:inputText>
							<h:outputText value="审批日期："></h:outputText>
							<p:inputText
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_F.qzrq}"
								readonly="true">
								<f:convertDateTime pattern="yyyy-MM-dd" locale="zh_CN"
									timeZone="GMT+8" />
							</p:inputText>
						</h:panelGrid>
						<h:panelGrid columns="2" width="900px" align="left" rendered="false">
							<h:outputText value="审批意见："></h:outputText>
							<p:inputTextarea rows="3"
								readonly="#{!zttzClsbSsbmZyJBean.showF}"
								style="border:#{zttzClsbSsbmZyJBean.taskNode=='专业组确认' ? '2px solid' : ''};border-color:#{zttzClsbSsbmZyJBean.taskNode=='专业组确认' ? '#46A3FF' : ''};"
								border="#{zttzClsbSsbmZyJBean.taskNode=='专业组确认' ? 1 : 0}"
								value="#{zttzClsbSsbmZyJBean.spjlSbZyBean.spjl_F.qznr}"
								cols="99" label="审批意见" maxlength="100"></p:inputTextarea>
						</h:panelGrid>
					</p:panel>
				</p:panelGrid>
			</p:tab>


			<p:tab title="附件">
				<h:panelGrid width="900px"
					style="margin-top: -10px;margin-left:-17px;">
					<h:panelGrid width="100%">
						<p:fileUpload multiple="true" update=":form:allform:filePaneId"
							fileUploadListener="#{zttzClsbSsbmZyJBean.handleFileUpload}"
							style="width:100%;" mode="advanced" label="浏览" cancelLabel="取消"
							uploadLabel="上传" sizeLimit="10240000"
							invalidSizeMessage="文件必须小于10M" invalidFileMessage="格式不支持"
							dragDropSupport="false"
							allowTypes="/(\.|\/)(gif|jpe?g|png|pdf|txt|rar|zip|doc|docx|xls|xlsx)$/">
						</p:fileUpload>
						<p:dataTable id="filePaneId" paginator="true" rows="10"
							rowIndexVar="rowVar" paginatorPosition="bottom"
							value="#{zttzClsbSsbmZyJBean.fileBean.files}" style="width:100%;"
							filterDelay="300" lazy="false" var="file"
							resizableColumns="true " liveResize="true"
							currentPageReportTemplate="总数: {totalRecords}, 当前页: {currentPage}/{totalPages}"
							paginatorTemplate="  {CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks}
                              {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							rowsPerPageTemplate="5,10,15">
							<h:outputText value="#{rowVar+1}" />
							<p:column headerText="序号" style="width:40px;">
								<h:outputText value="#{rowVar+1}" />
							</p:column>

							<p:column headerText="附件名称" style="width:50%">
								<h:outputText value="#{file.wjmc}" />
							</p:column>

							<p:column headerText="上传节点" style="width:70px">
								<p:outputLabel value="#{file.taskNode}"></p:outputLabel>
							</p:column>
							<p:column headerText="上传人员" style="width:70px">
								<p:outputLabel value="#{file.scyhid}"></p:outputLabel>
							</p:column>
							<p:column headerText="上传时间" style="width:70px">
								<h:outputText value="#{file.scrq}">
									<f:convertDateTime pattern="yyyy-MM-dd" locale="zh_CN"
										timeZone="GMT+8" />
								</h:outputText>
							</p:column>
							<p:column headerText="操作" style="width:10%">
								<h:panelGroup>
									<p:commandButton id="downId" ajax="false"
										action="#{zttzClsbSsbmZyJBean.fileBean.downFile}"
										icon="ui-icon-arrowthick-1-s" immediate="true">
										<f:setPropertyActionListener
											target="#{zttzClsbSsbmZyJBean.fileBean.file}" value="#{file}"></f:setPropertyActionListener>
									</p:commandButton>
									<h:outputText value="  "></h:outputText>
									<p:commandButton id="deleteId" ajax="false"
										update=":form:allform:filePaneId"
										disabled="#{file.scyhbm eq zttzClsbSsbmZyJBean.currentUser.yhbm and file.taskNode eq zttzClsbSsbmZyJBean.taskNode ? false : true}"
										action="#{zttzClsbSsbmZyJBean.fileBean.deleteFile}"
										icon="ui-icon-trash" oncomplete="PF('dialog').show()">
										<p:confirm icon="ui-icon-alert" message="确定删除吗?"></p:confirm>
										<f:setPropertyActionListener
											target="#{zttzClsbSsbmZyJBean.fileBean.file}" value="#{file}"></f:setPropertyActionListener>
									</p:commandButton>
								</h:panelGroup>
							</p:column>
						</p:dataTable>
					</h:panelGrid>
				</h:panelGrid>
			</p:tab>


			<p:tab title="审批日志">
				<h:panelGrid
					style="text-align: left; width:90%;margin-top:-10px;margin-left:-17px;">
					<h:panelGrid width="900px">

						<p:dataTable var="qzjl" value="#{zttzClsbSsbmZyJBean.wfLogList}"
							rows="500" rowIndexVar="rowVar" style="width:100%" lazy="true">
							<p:column headerText="序号" style="width:40px;">
								<h:outputText value="#{rowVar+1}" />
							</p:column>
							<p:column headerText="签字用户">
								<h:outputText value="#{qzjl.qzry.zsmc}" />
							</p:column>
							<p:column headerText="签字日期">
								<h:outputText value="#{qzjl.qzsj}" />
							</p:column>
							<p:column headerText="签字内容">
								<h:outputText value="#{qzjl.qznr}" />
							</p:column>
							<p:column headerText="审批结论">
								<h:outputText value="#{qzjl.jlmc}" />
							</p:column>
							<p:column headerText="当前节点">
								<h:outputText value="#{qzjl.nodeName}" />
							</p:column>
							<p:column headerText="操作指令">
								<h:outputText value="#{qzjl.transitionName}" />
							</p:column>

						</p:dataTable>
					</h:panelGrid>
				</h:panelGrid>
			</p:tab>
		</p:tabView>



		<h:panelGrid columns="4" style="margin-left: 200px;">




			<p:dialog id="prodialogPub" height="30" style="position: absolute;"
				closable="false" widgetVar="proDiaWidPub" resizable="false">
				<p:progressBar id="progressBarClientPub" labelTemplate="连接SAP中..."
					widgetVar="pbClient" style="width:300px;" />
			</p:dialog>

			<h:panelGroup>
				<c:forEach var="availableTransition"
					items="#{wftaskBean.availableTransitions}">
					<c:set var="availableTransition" value="#{availableTransition}" />
					<p:commandButton ajax="false"
						rendered="#{(availableTransition.name=='退回修改' )?false:true}"
						id="#{availableTransition.name}" action="#{wftaskBean.outcome}"
						value="#{availableTransition.name}"
						actionListener="#{wftaskBean.processAction}" immediate="false"
						onclick="PF('proDiaWidPub').show();start();">
					</p:commandButton>
					<f:verbatim>&nbsp;&nbsp;&nbsp;&nbsp;</f:verbatim>
				</c:forEach>
				<p:commandButton value="退回修改"
					rendered="#{!(wftaskBean.availableTransitions==null) and !zttzClsbSsbmZyJBean.showA and !zttzClsbSsbmZyJBean.showF}"
					ajax="false" immediate="true"
					onclick="PF('dlg1').show(); return false ; ">
				</p:commandButton>


				<p:commandButton value="任务召回" ajax="false"
					rendered="#{wftaskBean.zhrw and wftaskBean.hasFunction}"
					action="#{wftaskBean.outcome}"
					actionListener="#{wftaskBean.processBackAction}" immediate="true">
				</p:commandButton>

			</h:panelGroup>

		</h:panelGrid>
	</h:form>


	<p:dialog id="basicDialog" header="退回修改" widgetVar="dlg1"
		maximizable="true" height="200px" width="400px" modal="true"
		closable="false">
		<h:form id="gzzx" enctype="multipart/form-data">
			<h:panelGrid id="hq">
				<p:inputTextarea value="#{zttzClsbSsbmZyJBean.ztxg.thyy}" rows="5"
					cols="45"></p:inputTextarea>
				<h:panelGrid columns="2">
					<p:outputLabel value="退回目标节点："></p:outputLabel>

					<h:selectOneMenu value="#{wftaskBean.targetNode}">
						<f:selectItems value="#{wftaskBean.targetNodes}"></f:selectItems>
					</h:selectOneMenu>
					<p:commandButton id="退回" ajax="false"
						action="#{wftaskBean.outcome}" value="确认"
						actionListener="#{wftaskBean.processAction}" immediate="false">
					</p:commandButton>

					<p:commandButton id="取消" ajax="true" update=":basicDialog"
						oncomplete="PF('dlg1').hide()" value="取消"
						actionListener="#{wftaskBean.cancelProcessAction}"
						immediate="false">
					</p:commandButton>
				</h:panelGrid>
			</h:panelGrid>
		</h:form>
	</p:dialog>
</body>

</html>